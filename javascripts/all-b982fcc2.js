function add_button(e){var t=e.id;if(t){var a=e.getElementsByTagName("a")[0];a.addEventListener("click",toggle,!1),bookmarks[t]&&add_class(a,"selected")}}function toggle(e){e.preventDefault();var t=e.target,a=t.parentNode.id;return bookmarks[a]?(delete bookmarks[a],remove_class(t,"selected")):(bookmarks[a]=!0,add_class(t,"selected")),store_state(),!1}function store_state(){var e=Object.keys(bookmarks).join();if(document.cookie="b="+e+"; expires = "+storage_expiry,history.pushState){var t=window.location.protocol+"//"+window.location.host+window.location.pathname;e.length>0&&(t+="#"+e),window.history.replaceState({path:t},"",t)}}function load_stored_state(){var e=[],t=("; "+document.cookie).split("; b=");2==t.length?e=t.pop().split(";").shift().split(","):window.location.hash&&(e=window.location.hash.split(","));for(var a={},n=0,o=e.length;o>n;n+=1)e[n].length>0&&(a[e[n]]=!0);return a}function get_storage_expiry(){var e=1577e7;return new Date((new Date).getTime()+e).toGMTString()}function toggle_class(e,t){has_class(e,t)?remove_class(e,t):add_class(e,t)}function has_class(e,t){return-1!==e.className.indexOf(t)}function add_class(e,t){e.className+=" "+t}function remove_class(e,t){e.className=e.className.replace(" "+t,"")}function make_timing(e){for(var t={elem:e},a=e.getElementsByTagName("time"),n=0,o=a.length;o>n;n+=1){var i=a[n];t[i.className]=Date.parse(i.getAttribute("dateTime"))}return t}function update_now(e){for(var t=new Date((new Date).getTime()-(window.debug_offset||0)),a=0,n=timings.length;n>a;a+=1){var o=timings[a];o.start<t&&o.end>t?(add_class(o.elem,"now"),e&&(o.elem.scrollIntoView(!0),e=!1)):remove_class(o.elem,"now")}setTimeout(update_now,6e4)}window.applicationCache&&(window.applicationCache.addEventListener("updateready",function(e){if(window.applicationCache.status==window.applicationCache.UPDATEREADY){var t=document.createElement("a");t.href="#",t.className="notif",t.innerHTML="Programme updated - tap to reload",t.addEventListener("click",function(e){return e.preventDefault(),location.reload(),!1}),add_class(document.body,"notif-container"),document.body.appendChild(t)}}),function(){try{window.applicationCache.update()}catch(e){}setTimeout(arguments.callee,6e4)}());var articles=document.getElementsByTagName("article"),storage_expiry=get_storage_expiry(),bookmarks=load_stored_state();store_state();for(var i=0,ilen=articles.length;ilen>i;i+=1){var article=articles[i];add_button(article)}for(var timings=[],articles=document.getElementsByTagName("article"),i=0,ilen=articles.length;ilen>i;i+=1){var article=articles[i];timings.push(make_timing(article))}update_now(!0);